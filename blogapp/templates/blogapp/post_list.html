{% extends 'blogapp/base.html' %}

{% block content %}

<!-- Headr slider -->
{% include 'blogapp/snipets/header_slider.html' %}



<!-- Search form -->
{% include 'blogapp/snipets/search.html' %}



<!-- Filter -->
<div class="col col-md-6 col-lg-4 mx-auto">
    <form class="input-group md-form" action="{% url 'blogapp:profile' %}" method="get">
        <label for="firter_author">Fiter by autor</label>
        <select class="browser-default custom-select" name="q" id="firter_author">
            <option value="" selected>All posts</option>
            <option value="my" />My posts</option>
            <option value="other" />Other posts</option>
        </select>
        <div class="input-group-prepend">
            <input class="btn btn-md  m-0 px-3 py-2 z-depth-0 waves-effect" type="submit" value="Filter" />
        </div>
    </form>
</div>

<div class="col-lg-8 mx-auto">
    <div class="container-fluid">

        <div style="display: grid; grid-gap: 1.5rem;
    grid-template-columns: repeat(auto-fill, minmax(288px, 1fr));
    grid-auto-flow: dense;">
            {% for post in posts %}
            <div class="card view overlay" id="thiscard" style="align-self: start;">
                {% if post.cover %}
                <div class="embed-responsive embed-responsive-4by3">
                    <img src="{{ post.cover.url }}" style="object-fit:cover; "
                        class="embed-responsive-item card-image-top" alt="narrower">
                </div>
                {% endif %}

                <div class="card-body">
                    <h4 class="card-title text-break overflow-hidden" style="line-height: 1.6; height: 3.2em;">
                        {{ post.title|capfirst }}
                    </h4>
                    <h6 class="card-subtitle pink-text mb-3">
                        {% if post.author %}
                        <span> {{ post.author.username|capfirst }}</span>
                        {% else %}
                        <p>No name</p>
                        {% endif %}

                        {% if post.published_date %}
                        <span>{{ post.published_date.date|date:"M Y" }}</span>
                        {% endif %}
                    </h6>

                    <p class="card-text text-break text-dark overflow-hidden" style="line-height: 1.6; height: 5.2em;">
                        {{ post.text|linebreaksbr|capfirst|truncatechars:120}}
                    </p>
                    <hr class="m-0">
                    <div class="py-3 text-muted">
                        <span class="float-left">See more...</span>
                        {% if post.published_date %}
                        <span class="float-right "> <i class="far fa-comment-alt"></i>
                            {{ post.new_comments.count }}</span>
                        {% endif %}
                    </div>
                </div>

                {% if request.user.is_authenticated %}
                <a href="{% url 'blogapp:post_detail' pk=post.pk %}">
                    <div class="mask rgba-white-slight flex-center"></div>
                </a>
                {% else %}
                <a class="nav-link p-3 hoverable" type="button" data-toggle="modal" data-target="#loginModal">
                    <div class="mask rgba-white-slight flex-center"></div>
                </a>
                {% endif %}

                
            </div>
            {% endfor %}
        </div>

        {% if not posts %}
        <div class="jumbotron text-center">
            <h1 class="display-3 blue-grey-text">No posts</h1>
            <p class="lead grey-text">Sorry, no posts in this list.</p>
            <hr class="my-2">
            <p class="lead">
                <a class="btn btn-primary btn-lg" href="{% url 'blogapp:post_new' %}" role="button">Make post</a>
            </p>
        </div>
        {% endif %}
    </div>
</div>
</div>
{% endblock %}